<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="naver-site-verification" content="760dcf2c928601f50f3941df3b6b4629fd244c7c" />
    <!-- Google Ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2182912223281192"
    crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-90VXCLXLJT"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-90VXCLXLJT');
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-245679127-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-245679127-1');
    </script>

    

    
    <title>BQML을 이용한 고객 분류 | Jang Minjee</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="Big Query,BigQueryML" />
    
    <meta name="description" content="개요 K means clustering을 빅쿼리 ML(BQML)을 사용하여 고객을 세분화 하기 GA360의 데이터를 빅쿼리에 적재해 ML학습하기 파이썬을 사용하여 빅쿼리와 연동하고 관련 그래프 시각화하기  목표 구글 브랜드 상품을 판매하는 실제 이커머스 스토어인 구글 머천다이스 스토어의 난독화된 GA360 12개월(2016년 8월~2017년 8월)의 데이터">
<meta property="og:type" content="article">
<meta property="og:title" content="BQML을 이용한 고객 분류">
<meta property="og:url" content="https://jmj3047.github.io/2023/03/10/BQML_Classification/index.html">
<meta property="og:site_name" content="Jang Minjee">
<meta property="og:description" content="개요 K means clustering을 빅쿼리 ML(BQML)을 사용하여 고객을 세분화 하기 GA360의 데이터를 빅쿼리에 적재해 ML학습하기 파이썬을 사용하여 빅쿼리와 연동하고 관련 그래프 시각화하기  목표 구글 브랜드 상품을 판매하는 실제 이커머스 스토어인 구글 머천다이스 스토어의 난독화된 GA360 12개월(2016년 8월~2017년 8월)의 데이터">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://jmj3047.github.io/images/BQML_Classification/Untitled.png">
<meta property="article:published_time" content="2023-03-09T15:00:00.000Z">
<meta property="article:modified_time" content="2023-03-19T07:02:05.304Z">
<meta property="article:author" content="Jang Minjee">
<meta property="article:tag" content="Big Query">
<meta property="article:tag" content="BigQueryML">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jmj3047.github.io/images/BQML_Classification/Untitled.png">
    

    

    
        <link rel="icon" href="/images/favicon.png" />
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/titillium-web/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">


    
<script src="/libs/jquery/3.5.0/jquery.min.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=[object Object]"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '[object Object]');
</script>
<!-- End Google Analytics -->

    
    
    


    
<link rel="stylesheet" href="https://cdn.rawgit.com/innks/NanumSquareRound/master/nanumsquareround.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" target="_blank" rel="noopener" href="https://github.com/jmj3047/mj_portfolio">About Me</a>
                                </li>
                            
                                    <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Data-Analysis/">Data Analysis</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Data-Analysis/Basic/">Basic</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Data-Analysis/Model/">Model</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Data-Platform-Base/">Data Platform/Base</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Data-Platform-Base/GCP/">GCP</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Data-Platform-Base/MongoDB/">MongoDB</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/">Paper</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Computer-Vision/">Computer Vision</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Few-Shot-Learning/">Few Shot Learning</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Generative-Model/">Generative Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Multi-Task-Learning/">Multi-Task Learning</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/NLP/">NLP</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Recommendation-System/">Recommendation System</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Speaker-Verification/">Speaker Verification</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Speech-Emotion-Recognition/">Speech Emotion Recognition</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Paper/Speech-Representations/">Speech Representations</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Python/">Python</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Python/Django/">Django</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Python/HTML/">HTML</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Python/Pyspark/">Pyspark</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Python/Python/">Python</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Quant/">Quant</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Setting/">Setting</a></li></ul>
                                
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Data-Platform-Base/">Data Platform/Base</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/categories/Data-Platform-Base/GCP/">GCP</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-BQML_Classification" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        BQML을 이용한 고객 분류
        </h1>
    

                
            </header>
        
        
            <div class="article-meta">
                
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2023/03/10/BQML_Classification/" class="article-date">
       <time datetime="2023-03-09T15:00:00.000Z" itemprop="datePublished">2023-03-10</time>
    </a>
  </div>


<div class="article-date">
  <i class="fa fa-calendar-plus-o"></i>
  <a href="/2023/03/10/BQML_Classification/" class="article-date">
     <time datetime="2023-03-19T07:02:05.304Z" itemprop="dateModified">2023-03-19</time>
  </a>
</div>


                

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/Big-Query/" rel="tag">Big Query</a>, <a class="tag-link-link" href="/tags/BigQueryML/" rel="tag">BigQueryML</a>
    </div>

                

                

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            

            

            

            <h2 id="개요"><a href="#개요" class="headerlink" title="개요"></a>개요</h2><ul>
<li>K means clustering을 빅쿼리 ML(BQML)을 사용하여 고객을 세분화 하기</li>
<li>GA360의 데이터를 빅쿼리에 적재해 ML학습하기</li>
<li>파이썬을 사용하여 빅쿼리와 연동하고 관련 그래프 시각화하기</li>
</ul>
<h2 id="목표"><a href="#목표" class="headerlink" title="목표"></a>목표</h2><ul>
<li>구글 브랜드 상품을 판매하는 실제 이커머스 스토어인 구글 머천다이스 스토어의 난독화된 GA360 12개월(2016년 8월~2017년 8월)의 데이터를 가지고 고객을 분류</li>
</ul>
<h2 id="환경-구축"><a href="#환경-구축" class="headerlink" title="환경 구축"></a>환경 구축</h2><ul>
<li><p>GCP와 주피터 노트북을 연결</p>
</li>
<li><p>config파일이 필요(<a href="https://jmj3047.github.io/2023/03/03/Kaggle_GCP/">이전포스트 설명</a>)</p>
<h3 id="PIP-install-packages-and-dependencies"><a href="#PIP-install-packages-and-dependencies" class="headerlink" title="PIP install packages and dependencies"></a>PIP install packages and dependencies</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">!pip install google-cloud-bigquery</span><br><span class="line">!pip install google-cloud-bigquery-storage</span><br><span class="line">!pip install pandas-gbq</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reservation package needed to setup flex slots for flat-rate pricing</span></span><br><span class="line">!pip install google-cloud-bigquery-reservation</span><br></pre></td></tr></table></figure>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Requirement already satisfied: google-cloud-bigquery in /opt/homebrew/lib/python3.10/site-packages (3.6.0)</span><br><span class="line">Requirement already satisfied: google-cloud-core&lt;3.0.0dev,&gt;=1.6.0 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (2.3.2)</span><br><span class="line">Requirement already satisfied: requests&lt;3.0.0dev,&gt;=2.21.0 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (2.28.2)</span><br><span class="line">Requirement already satisfied: protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.19.5 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (4.22.1)</span><br><span class="line">Requirement already satisfied: grpcio&lt;2.0dev,&gt;=1.47.0 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (1.51.3)</span><br><span class="line">Requirement already satisfied: google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (2.11.0)</span><br><span class="line">Requirement already satisfied: google-resumable-media&lt;3.0dev,&gt;=0.6.0 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (2.4.1)</span><br><span class="line">Requirement already satisfied: packaging&gt;=20.0.0 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (23.0)</span><br><span class="line">Requirement already satisfied: python-dateutil&lt;3.0dev,&gt;=2.7.2 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (2.8.2)</span><br><span class="line">Requirement already satisfied: proto-plus&lt;2.0.0dev,&gt;=1.15.0 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery) (1.22.2)</span><br><span class="line">Requirement already satisfied: google-auth&lt;3.0dev,&gt;=2.14.1 in /opt/homebrew/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5-&gt;google-cloud-bigquery) (2.16.1)</span><br><span class="line">Requirement already satisfied: googleapis-common-protos&lt;2.0dev,&gt;=1.56.2 in /opt/homebrew/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5-&gt;google-cloud-bigquery) (1.58.0)</span><br><span class="line">Requirement already satisfied: grpcio-status&lt;2.0dev,&gt;=1.33.2 in /opt/homebrew/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5-&gt;google-cloud-bigquery) (1.51.3)</span><br><span class="line">Requirement already satisfied: google-crc32c&lt;2.0dev,&gt;=1.0 in /opt/homebrew/lib/python3.10/site-packages (from google-resumable-media&lt;3.0dev,&gt;=0.6.0-&gt;google-cloud-bigquery) (1.5.0)</span><br><span class="line">Requirement already satisfied: six&gt;=1.5 in /opt/homebrew/lib/python3.10/site-packages (from python-dateutil&lt;3.0dev,&gt;=2.7.2-&gt;google-cloud-bigquery) (1.16.0)</span><br><span class="line">Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/homebrew/lib/python3.10/site-packages (from requests&lt;3.0.0dev,&gt;=2.21.0-&gt;google-cloud-bigquery) (3.4)</span><br><span class="line">Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /opt/homebrew/lib/python3.10/site-packages (from requests&lt;3.0.0dev,&gt;=2.21.0-&gt;google-cloud-bigquery) (3.0.1)</span><br><span class="line">Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /opt/homebrew/lib/python3.10/site-packages (from requests&lt;3.0.0dev,&gt;=2.21.0-&gt;google-cloud-bigquery) (1.26.14)</span><br><span class="line">Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/homebrew/lib/python3.10/site-packages (from requests&lt;3.0.0dev,&gt;=2.21.0-&gt;google-cloud-bigquery) (2022.12.7)</span><br><span class="line">Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /opt/homebrew/lib/python3.10/site-packages (from google-auth&lt;3.0dev,&gt;=2.14.1-&gt;google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5-&gt;google-cloud-bigquery) (0.2.8)</span><br><span class="line">Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /opt/homebrew/lib/python3.10/site-packages (from google-auth&lt;3.0dev,&gt;=2.14.1-&gt;google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5-&gt;google-cloud-bigquery) (4.9)</span><br><span class="line">Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /opt/homebrew/lib/python3.10/site-packages (from google-auth&lt;3.0dev,&gt;=2.14.1-&gt;google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5-&gt;google-cloud-bigquery) (5.3.0)</span><br><span class="line">Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /opt/homebrew/lib/python3.10/site-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3.0dev,&gt;=2.14.1-&gt;google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,&lt;3.0.0dev,&gt;=1.31.5-&gt;google-cloud-bigquery) (0.4.8)</span><br><span class="line">Requirement already satisfied: google-cloud-bigquery-storage in /opt/homebrew/lib/python3.10/site-packages (2.19.0)</span><br><span class="line">Requirement already satisfied: protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.19.5 in /opt/homebrew/lib/python3.10/site-packages (from google-cloud-bigquery-storage) (4.22.1)</span><br><span class="line">...</span><br><span class="line">Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/homebrew/lib/python3.10/site-packages (from requests&lt;3.0.0dev,&gt;=2.18.0-&gt;google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,&lt;3.0.0dev,&gt;=1.34.0-&gt;google-cloud-bigquery-reservation) (2022.12.7)</span><br><span class="line">Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /opt/homebrew/lib/python3.10/site-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3.0dev,&gt;=2.14.1-&gt;google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,&lt;3.0.0dev,&gt;=1.34.0-&gt;google-cloud-bigquery-reservation) (0.4.8)</span><br><span class="line">Installing collected packages: google-cloud-bigquery-reservation</span><br><span class="line">Successfully installed google-cloud-bigquery-reservation-1.10.0</span><br></pre></td></tr></table></figure>
<ul>
<li><p>설치 후 커널 다시 시작</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Automatically restart kernel after installs</span></span><br><span class="line"><span class="keyword">import</span> IPython</span><br><span class="line">app = IPython.Application.instance()</span><br><span class="line">app.kernel.do_shutdown(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled.png" alt=" "></p>
</li>
</ul>
<h3 id="Project-ID와-인증"><a href="#Project-ID와-인증" class="headerlink" title="Project ID와 인증"></a>Project ID와 인증</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PROJECT_ID = <span class="string">&quot;your-project-id&quot;</span> </span><br><span class="line">REGION = <span class="string">&#x27;US&#x27;</span></span><br><span class="line">DATA_SET_ID = <span class="string">&#x27;bqml_kmeans&#x27;</span> <span class="comment"># Ensure you first create a data set in BigQuery</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If you have not built the Data Set, the following command will build it for you</span></span><br><span class="line">!bq mk --location=$REGION --dataset $PROJECT_ID:$DATA_SET_ID </span><br><span class="line"></span><br><span class="line">!gcloud config <span class="built_in">set</span> project $PROJECT_ID</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%201.png" alt=" "></p>
<h3 id="Import-libraries-and-define-constants"><a href="#Import-libraries-and-define-constants" class="headerlink" title="Import libraries and define constants"></a>Import libraries and define constants</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">from</span> google.cloud <span class="keyword">import</span> bigquery</span><br><span class="line"><span class="keyword">from</span> google.oauth2 <span class="keyword">import</span> service_account</span><br><span class="line"><span class="keyword">from</span> google.cloud <span class="keyword">import</span> bigquery</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pandas_gbq</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 서비스 계정 키 JSON 파일 경로</span></span><br><span class="line">key_path = glob.glob(<span class="string">&quot;./config/*.json&quot;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Credentials 객체 생성</span></span><br><span class="line">credentials = service_account.Credentials.from_service_account_file(key_path)</span><br><span class="line"></span><br><span class="line">project_id=<span class="string">&quot;your-project-id&quot;</span></span><br><span class="line"><span class="comment"># GCP 클라이언트 객체 생성</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.float_format&#x27;</span>, <span class="keyword">lambda</span> x: <span class="string">&#x27;%.3f&#x27;</span> % x) <span class="comment"># used to display float format</span></span><br><span class="line">client = bigquery.Client(credentials = credentials, </span><br><span class="line">                         project = credentials.project_id)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="데이터"><a href="#데이터" class="headerlink" title="데이터"></a>데이터</h2><p>모델을 구축하기 전에 일반적으로 모델링을 위해 의미 있는 방식으로 데이터 집합을 정리, 탐색 및 집계하는 데 상당한 시간을 투자해야 함. 이 포스트 목적상 이 단계는 BigQuery ML에서 k-평균을 사용한 클러스터링을 우선적으로 보여주기 위해 표시하지 않음.</p>
<h3 id="GA360-GA4차이"><a href="#GA360-GA4차이" class="headerlink" title="GA360, GA4차이"></a>GA360, GA4차이</h3><ul>
<li>GA360<ul>
<li>GA의 유료 버전으로 무료 버전과 가장 큰 차이점은 ‘데이터 소유권’</li>
<li>데이터 소유권이 구글인 무료 버전에 비해 GA360은 데이터 소유권이 사용자</li>
<li>때문에 데이터 샘플링이 없고 빅쿼리를 통해 Raw Data를 이용할 수 있음.</li>
<li>다만 유료인만큼 연간 1.5억의 사용료를 지불해야 함.</li>
</ul>
</li>
<li>GA4<ul>
<li>2019년에 새로 생긴 구글 애널리틱스로 WEB과 APP을 심리스하게 보기 위한 GA</li>
<li>360처럼 유료 버전을 쓰지 않아도 빅쿼리로 데이터를 보내주기 때문에 Raw Data를 쿼리 비용만 내고 사용할수 있음.</li>
<li>GA4 UI에선 속도가 매우 빠르지만 GAUI에 비해 GA4 UI에서는 많은 것으르 보옂쥐 않고 데이터 분석을 위해 제대로 사용하기 위해서는 빅쿼리에 익숙애햐 함.</li>
</ul>
</li>
</ul>
<h2 id="합성-데이터-구축"><a href="#합성-데이터-구축" class="headerlink" title="합성 데이터 구축"></a>합성 데이터 구축</h2><ul>
<li><p>최종 목표는 온라인(GA360) 및 오프라인(CRM) 데이터를 모두 사용하는 것.</p>
</li>
<li><p>자체 CRM 데이터를 사용할 수도 있지만, 이 경우에는 보여줄 CRM 데이터가 없으므로 대신 합성 데이터를 생성: 예상 가구 소득(House Hold income, hhi)과 성별</p>
</li>
<li><p>이를 위해 전체 방문자 ID를 해시하고 해시의 마지막 숫자를 기반으로 간단한 규칙을 구축합니다.</p>
<ul>
<li>hash: 임의의 길이를 갖는 임의의 데이터를 고정된 길이의 데이터로 매핑하는 것</li>
</ul>
</li>
<li><p>자체 데이터로 이 프로세스를 실행하면 여러 차원으로 CRM 데이터를 조인할 수 있음.</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># We start with GA360 data, and will eventually build synthetic CRM as an example.  </span></span><br><span class="line"><span class="comment"># This block is the first step, just working with GA360</span></span><br><span class="line"></span><br><span class="line">ga360_only_view = <span class="string">&#x27;GA360_View&#x27;</span></span><br><span class="line">shared_dataset_ref = client.dataset(DATA_SET_ID)</span><br><span class="line">ga360_view_ref = shared_dataset_ref.table(ga360_only_view)</span><br><span class="line">ga360_view = bigquery.Table(ga360_view_ref)</span><br><span class="line"></span><br><span class="line">ga360_query = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT</span></span><br><span class="line"><span class="string">  fullVisitorID,</span></span><br><span class="line"><span class="string">  ABS(farm_fingerprint(fullVisitorID)) AS Hashed_fullVisitorID, # This will be used to generate random data.</span></span><br><span class="line"><span class="string">  MAX(device.operatingSystem) AS OS, # We can aggregate this because an OS is tied to a fullVisitorID.</span></span><br><span class="line"><span class="string">  SUM (CASE</span></span><br><span class="line"><span class="string">       WHEN REGEXP_EXTRACT (v2ProductCategory, </span></span><br><span class="line"><span class="string">                           r&#x27;^(?:(?:.*?)Home/)(.*?)/&#x27;) </span></span><br><span class="line"><span class="string">                           = &#x27;Apparel&#x27; THEN 1 ELSE 0 END) AS Apparel,</span></span><br><span class="line"><span class="string">  SUM (CASE  </span></span><br><span class="line"><span class="string">       WHEN REGEXP_EXTRACT (v2ProductCategory, </span></span><br><span class="line"><span class="string">                           r&#x27;^(?:(?:.*?)Home/)(.*?)/&#x27;) </span></span><br><span class="line"><span class="string">                           = &#x27;Office&#x27; THEN 1 ELSE 0 END) AS Office,</span></span><br><span class="line"><span class="string">  SUM (CASE</span></span><br><span class="line"><span class="string">       WHEN REGEXP_EXTRACT (v2ProductCategory, </span></span><br><span class="line"><span class="string">                           r&#x27;^(?:(?:.*?)Home/)(.*?)/&#x27;) </span></span><br><span class="line"><span class="string">                           = &#x27;Electronics&#x27; THEN 1 ELSE 0 END) AS Electronics,</span></span><br><span class="line"><span class="string">  SUM (CASE</span></span><br><span class="line"><span class="string">       WHEN REGEXP_EXTRACT (v2ProductCategory, </span></span><br><span class="line"><span class="string">                           r&#x27;^(?:(?:.*?)Home/)(.*?)/&#x27;) </span></span><br><span class="line"><span class="string">                           = &#x27;Limited Supply&#x27; THEN 1 ELSE 0 END) AS LimitedSupply,</span></span><br><span class="line"><span class="string">  SUM (CASE</span></span><br><span class="line"><span class="string">       WHEN REGEXP_EXTRACT (v2ProductCategory, </span></span><br><span class="line"><span class="string">                           r&#x27;^(?:(?:.*?)Home/)(.*?)/&#x27;) </span></span><br><span class="line"><span class="string">                           = &#x27;Accessories&#x27; THEN 1 ELSE 0 END) AS Accessories,</span></span><br><span class="line"><span class="string">  SUM (CASE</span></span><br><span class="line"><span class="string">       WHEN REGEXP_EXTRACT (v2ProductCategory, </span></span><br><span class="line"><span class="string">                           r&#x27;^(?:(?:.*?)Home/)(.*?)/&#x27;) </span></span><br><span class="line"><span class="string">                           = &#x27;Shop by Brand&#x27; THEN 1 ELSE 0 END) AS ShopByBrand,</span></span><br><span class="line"><span class="string">  SUM (CASE</span></span><br><span class="line"><span class="string">       WHEN REGEXP_EXTRACT (v2ProductCategory, </span></span><br><span class="line"><span class="string">                           r&#x27;^(?:(?:.*?)Home/)(.*?)/&#x27;) </span></span><br><span class="line"><span class="string">                           = &#x27;Bags&#x27; THEN 1 ELSE 0 END) AS Bags,</span></span><br><span class="line"><span class="string">  ROUND (SUM (productPrice/1000000),2) AS productPrice_USD</span></span><br><span class="line"><span class="string">FROM</span></span><br><span class="line"><span class="string">  `bigquery-public-data.google_analytics_sample.ga_sessions_*`,</span></span><br><span class="line"><span class="string">  UNNEST(hits) AS hits,</span></span><br><span class="line"><span class="string">  UNNEST(hits.product) AS hits_product</span></span><br><span class="line"><span class="string">WHERE</span></span><br><span class="line"><span class="string">  _TABLE_SUFFIX BETWEEN &#x27;20160801&#x27;</span></span><br><span class="line"><span class="string">  AND &#x27;20160831&#x27;</span></span><br><span class="line"><span class="string">  AND geoNetwork.country = &#x27;United States&#x27;</span></span><br><span class="line"><span class="string">  AND type = &#x27;EVENT&#x27;</span></span><br><span class="line"><span class="string">GROUP BY</span></span><br><span class="line"><span class="string">  1,</span></span><br><span class="line"><span class="string">  2</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">ga360_view.view_query = ga360_query.<span class="built_in">format</span>(PROJECT_ID)</span><br><span class="line">ga360_view = client.create_table(ga360_view)  <span class="comment"># API request</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Successfully created view at <span class="subst">&#123;ga360_view.full_table_id&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%202.png" alt=" "></p>
</li>
<li><p>데이터 확인</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show a sample of GA360 data</span></span><br><span class="line"></span><br><span class="line">ga360_query_df = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT * FROM <span class="subst">&#123;ga360_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span> LIMIT 5</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">job_config = bigquery.QueryJobConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the query</span></span><br><span class="line">query_job = client.query(ga360_query_df, job_config=job_config) <span class="comment">#API Request</span></span><br><span class="line">df_ga360 = query_job.result()</span><br><span class="line">df_ga360 = df_ga360.to_dataframe()</span><br><span class="line"></span><br><span class="line">df_ga360</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%203.png" alt=" "></p>
</li>
<li><p>CRM data 추출하여 합성데이터 만들기</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create synthetic CRM data in SQL</span></span><br><span class="line"></span><br><span class="line">CRM_only_view = <span class="string">&#x27;CRM_View&#x27;</span></span><br><span class="line">shared_dataset_ref = client.dataset(DATA_SET_ID)</span><br><span class="line">CRM_view_ref = shared_dataset_ref.table(CRM_only_view)</span><br><span class="line">CRM_view = bigquery.Table(CRM_view_ref)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Query below works by hashing the fullVisitorID, which creates a random distribution.  </span></span><br><span class="line"><span class="comment"># We use modulo to artificially split gender and hhi distribution.</span></span><br><span class="line">CRM_query = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT</span></span><br><span class="line"><span class="string">  fullVisitorID,</span></span><br><span class="line"><span class="string">IF</span></span><br><span class="line"><span class="string">  (MOD(Hashed_fullVisitorID,2) = 0,</span></span><br><span class="line"><span class="string">    &quot;M&quot;,</span></span><br><span class="line"><span class="string">    &quot;F&quot;) AS gender,</span></span><br><span class="line"><span class="string">  CASE</span></span><br><span class="line"><span class="string">    WHEN MOD(Hashed_fullVisitorID,10) = 0 THEN 55000</span></span><br><span class="line"><span class="string">    WHEN MOD(Hashed_fullVisitorID,10) &lt; 3 THEN 65000</span></span><br><span class="line"><span class="string">    WHEN MOD(Hashed_fullVisitorID,10) &lt; 7 THEN 75000</span></span><br><span class="line"><span class="string">    WHEN MOD(Hashed_fullVisitorID,10) &lt; 9 THEN 85000</span></span><br><span class="line"><span class="string">    WHEN MOD(Hashed_fullVisitorID,10) = 9 THEN 95000</span></span><br><span class="line"><span class="string">  ELSE</span></span><br><span class="line"><span class="string">  Hashed_fullVisitorID</span></span><br><span class="line"><span class="string">END</span></span><br><span class="line"><span class="string">  AS hhi</span></span><br><span class="line"><span class="string">FROM (</span></span><br><span class="line"><span class="string">  SELECT</span></span><br><span class="line"><span class="string">    fullVisitorID,</span></span><br><span class="line"><span class="string">    ABS(farm_fingerprint(fullVisitorID)) AS Hashed_fullVisitorID,</span></span><br><span class="line"><span class="string">  FROM</span></span><br><span class="line"><span class="string">    `bigquery-public-data.google_analytics_sample.ga_sessions_*`,</span></span><br><span class="line"><span class="string">    UNNEST(hits) AS hits,</span></span><br><span class="line"><span class="string">    UNNEST(hits.product) AS hits_product</span></span><br><span class="line"><span class="string">  WHERE</span></span><br><span class="line"><span class="string">    _TABLE_SUFFIX BETWEEN &#x27;20160801&#x27;</span></span><br><span class="line"><span class="string">    AND &#x27;20160831&#x27;</span></span><br><span class="line"><span class="string">    AND geoNetwork.country = &#x27;United States&#x27;</span></span><br><span class="line"><span class="string">    AND type = &#x27;EVENT&#x27;</span></span><br><span class="line"><span class="string">  GROUP BY</span></span><br><span class="line"><span class="string">    1,</span></span><br><span class="line"><span class="string">    2)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">CRM_view.view_query = CRM_query.<span class="built_in">format</span>(PROJECT_ID)</span><br><span class="line">CRM_view = client.create_table(CRM_view)  <span class="comment"># API request</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Successfully created view at <span class="subst">&#123;CRM_view.full_table_id&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%204.png" alt=" "></p>
</li>
<li><p>데이터 확인</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># See an output of the synthetic CRM data</span></span><br><span class="line"></span><br><span class="line">CRM_query_df = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT * FROM <span class="subst">&#123;CRM_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span> LIMIT 5</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">job_config = bigquery.QueryJobConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the query</span></span><br><span class="line">query_job = client.query(CRM_query_df, job_config=job_config) <span class="comment">#API Request</span></span><br><span class="line">df_CRM = query_job.result()</span><br><span class="line">df_CRM = df_CRM.to_dataframe()</span><br><span class="line"></span><br><span class="line">df_CRM</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%205.png" alt=" "></p>
</li>
</ul>
<h2 id="클러스터링을-위한-학습-데이터로-사용할-최종뷰-작성"><a href="#클러스터링을-위한-학습-데이터로-사용할-최종뷰-작성" class="headerlink" title="클러스터링을 위한 학습 데이터로 사용할 최종뷰 작성"></a>클러스터링을 위한 학습 데이터로 사용할 최종뷰 작성</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Build a final view, which joins GA360 data with CRM data</span></span><br><span class="line"></span><br><span class="line">final_data_view = <span class="string">&#x27;Final_View&#x27;</span></span><br><span class="line">shared_dataset_ref = client.dataset(DATA_SET_ID)</span><br><span class="line">final_view_ref = shared_dataset_ref.table(final_data_view)</span><br><span class="line">final_view = bigquery.Table(final_view_ref)</span><br><span class="line"></span><br><span class="line">final_data_query = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT</span></span><br><span class="line"><span class="string">    g.*,</span></span><br><span class="line"><span class="string">    c.* EXCEPT(fullVisitorId)</span></span><br><span class="line"><span class="string">FROM <span class="subst">&#123;ga360_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span> g</span></span><br><span class="line"><span class="string">JOIN <span class="subst">&#123;CRM_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span> c</span></span><br><span class="line"><span class="string">ON g.fullVisitorId = c.fullVisitorId</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">final_view.view_query = final_data_query.<span class="built_in">format</span>(PROJECT_ID)</span><br><span class="line">final_view = client.create_table(final_view)  <span class="comment"># API request</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Successfully created view at <span class="subst">&#123;final_view.full_table_id&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>데이터 시각화</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show final data used prior to modeling</span></span><br><span class="line"></span><br><span class="line">sql_demo = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT * FROM <span class="subst">&#123;final_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span> LIMIT 5</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">job_config = bigquery.QueryJobConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the query</span></span><br><span class="line">query_job = client.query(sql_demo, job_config=job_config) <span class="comment">#API Request</span></span><br><span class="line">df_demo = query_job.result()</span><br><span class="line">df_demo = df_demo.to_dataframe()</span><br><span class="line"></span><br><span class="line">df_demo</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%206.png" alt=" "></p>
</li>
</ul>
<h2 id="K-Means-Model"><a href="#K-Means-Model" class="headerlink" title="K-Means Model"></a>K-Means Model</h2><h3 id="초기-모델-만들기"><a href="#초기-모델-만들기" class="headerlink" title="초기 모델 만들기"></a>초기 모델 만들기</h3><ul>
<li>초기 k-means model을 구축</li>
<li>아직 최적의 k 또는 다른 하이퍼 파라미터에는 초점을 맞추지 않겠습니다.</li>
<li>몇 가지 추가 사항<ol>
<li>클러스터링을 위한 피처로 fullVisitorID가 필요하지 않기 때문에 해당 수준에서 그룹화되어 있더라도 fullVisitorID를 입력에서 제거. 전체 방문자 ID를 피처로 사용해서는 안됨.</li>
<li>범주형 피처와 숫자 피처가 모두 존재</li>
<li>숫자 피처를 정규화할 필요가 없는데, 이는 BigQuery ML이 자동으로 수행하기 때문</li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">makeModel</span> (n_Clusters, Model_Name):</span><br><span class="line">    sql =<span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    CREATE OR REPLACE MODEL `<span class="subst">&#123;PROJECT_ID&#125;</span>.<span class="subst">&#123;DATA_SET_ID&#125;</span>.<span class="subst">&#123;Model_Name&#125;</span>` </span></span><br><span class="line"><span class="string">    OPTIONS(model_type=&#x27;kmeans&#x27;,</span></span><br><span class="line"><span class="string">    kmeans_init_method = &#x27;KMEANS++&#x27;,</span></span><br><span class="line"><span class="string">    num_clusters=<span class="subst">&#123;n_Clusters&#125;</span>) AS</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    SELECT * except(fullVisitorID, Hashed_fullVisitorID) FROM `<span class="subst">&#123;final_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span>`</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    job_config = bigquery.QueryJobConfig()</span><br><span class="line">    client.query(sql, job_config=job_config)  <span class="comment"># Make an API request.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Let&#x27;s start with a simple test to ensure everything works. </span></span><br><span class="line"><span class="comment"># After running makeModel(), allow a few minutes for training to complete.</span></span><br><span class="line"></span><br><span class="line">model_test_name = <span class="string">&quot;test&quot;</span></span><br><span class="line">makeModel(<span class="number">3</span>, model_test_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># After training is completed, you can either check in the UI, or you can interact with it using list_models(). </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> model <span class="keyword">in</span> client.list_models(DATA_SET_ID):</span><br><span class="line">    <span class="built_in">print</span>(model)</span><br></pre></td></tr></table></figure>

<p><img src="/images/BQML_Classification/Untitled%207.png" alt=" "></p>
<h3 id="더-나은-모델을-만들기-위한-작업"><a href="#더-나은-모델을-만들기-위한-작업" class="headerlink" title="더 나은 모델을 만들기 위한 작업"></a>더 나은 모델을 만들기 위한 작업</h3><ul>
<li><p>올바른 k 값을 결정하는 것은 전적으로 사용 사례에 따라 달라짐.<br>ex) 손으로 쓴 숫자를 사전 처리 → k &#x3D; 10<br>   비즈니스 이해관계자가 세 개의 서로 다른 마케팅 캠페인만 제공하고자 하고 세 개의 고객 클러스터를 식별해야 하는 경우 → k&#x3D;3</p>
</li>
<li><p>그러나 현업에서 위의 예시처럼 딱 떨어지는 사용 사례는 거의 없기 때문에 보통 k의 범위를 지정하고 그 안에서 결과값이 좋은 k를 선택하기도 함.</p>
</li>
<li><p>k 값을 결정하기 위한 수단으로 엘보우 방법을 수행한후 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Davies%E2%80%93Bouldin_index">데이비스-볼딘 점수</a>로 평가함.</p>
</li>
<li><p>DBI가 작을수록 cluster를 자세히 구분했다고 말할수 있음(<a href="https://jmj3047.github.io/2023/03/11/K-Means_Clustering_2/">관련 포스트</a>)</p>
</li>
<li><p>아래에서는 엘보 방법을 모두 수행하고 데이비스-볼딘 점수를 얻기 위한 몇 가지 모델을 생성함.</p>
</li>
<li><p>low_k, high_k: 하이퍼 파라미터, 두 값 사이의 모델을 생성.</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define upper and lower bound for k, then build individual models for each. </span></span><br><span class="line"><span class="comment"># After running this loop, look at the UI to see several model objects that exist. </span></span><br><span class="line"></span><br><span class="line">low_k = <span class="number">3</span></span><br><span class="line">high_k = <span class="number">15</span></span><br><span class="line">model_prefix_name = <span class="string">&#x27;kmeans_clusters_&#x27;</span></span><br><span class="line"></span><br><span class="line">lst = <span class="built_in">list</span>(<span class="built_in">range</span> (low_k, high_k+<span class="number">1</span>)) <span class="comment">#build list to iterate through k values</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> lst:</span><br><span class="line">    model_name = model_prefix_name + <span class="built_in">str</span>(k)</span><br><span class="line">    makeModel(k, model_name)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Model started: <span class="subst">&#123;model_name&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%208.png" alt=" "></p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># list all current models</span></span><br><span class="line">models = client.list_models(DATA_SET_ID)  <span class="comment"># Make an API request.</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Listing current models:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> model <span class="keyword">in</span> models:</span><br><span class="line">    full_model_id = <span class="string">f&quot;<span class="subst">&#123;model.dataset_id&#125;</span>.<span class="subst">&#123;model.model_id&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(full_model_id)</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%209.png" alt=" "></p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Remove our sample model from BigQuery, so we only have remaining models from our previous loop</span></span><br><span class="line"></span><br><span class="line">model_id = DATA_SET_ID+<span class="string">&quot;.&quot;</span>+model_test_name</span><br><span class="line">client.delete_model(model_id)  <span class="comment"># Make an API request.</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Deleted model &#x27;<span class="subst">&#123;model_id&#125;</span>&#x27;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%2010.png" alt=" "></p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This will create a dataframe with each model name, the Davies Bouldin Index, and Loss.  </span></span><br><span class="line"><span class="comment"># It will be used for the elbow method and to help determine optimal K</span></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(columns=[<span class="string">&#x27;davies_bouldin_index&#x27;</span>, <span class="string">&#x27;mean_squared_distance&#x27;</span>])</span><br><span class="line">models = client.list_models(DATA_SET_ID)  <span class="comment"># Make an API request.</span></span><br><span class="line"><span class="keyword">for</span> model <span class="keyword">in</span> models:</span><br><span class="line">    full_model_id = <span class="string">f&quot;<span class="subst">&#123;model.dataset_id&#125;</span>.<span class="subst">&#123;model.model_id&#125;</span>&quot;</span></span><br><span class="line">    sql =<span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        SELECT </span></span><br><span class="line"><span class="string">            davies_bouldin_index,</span></span><br><span class="line"><span class="string">            mean_squared_distance </span></span><br><span class="line"><span class="string">        FROM ML.EVALUATE(MODEL `<span class="subst">&#123;full_model_id&#125;</span>`)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    job_config = bigquery.QueryJobConfig()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Start the query, passing in the extra configuration.</span></span><br><span class="line">    query_job = client.query(sql, job_config=job_config)  <span class="comment"># Make an API request.</span></span><br><span class="line">    df_temp = query_job.to_dataframe()  <span class="comment"># Wait for the job to complete.</span></span><br><span class="line">    df_temp[<span class="string">&#x27;model_name&#x27;</span>] = model.model_id</span><br><span class="line">    df =  pd.concat([df, df_temp], axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>아래 코드는 원래 이 노트북에서 만든 명명 규칙을 사용했으며, 두 번째 밑줄 뒤에 k 값이 있다고 가정.</p>
</li>
<li><p>model_prefix_name 변수를 변경한 경우, 이 코드가 깨질 수 있음.</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This will modify the dataframe above, produce a new field with &#x27;n_clusters&#x27;, and will sort for graphing</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">&#x27;n_clusters&#x27;</span>] = df[<span class="string">&#x27;model_name&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;_&#x27;</span>).<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x[<span class="number">2</span>])</span><br><span class="line">df[<span class="string">&#x27;n_clusters&#x27;</span>] = df[<span class="string">&#x27;n_clusters&#x27;</span>].apply(pd.to_numeric)</span><br><span class="line">df = df.sort_values(by=<span class="string">&#x27;n_clusters&#x27;</span>, ascending=<span class="literal">True</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%2011.png" alt=" "></p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.plot.line(x=<span class="string">&#x27;n_clusters&#x27;</span>, y=[<span class="string">&#x27;davies_bouldin_index&#x27;</span>, <span class="string">&#x27;mean_squared_distance&#x27;</span>])</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/images/BQML_Classification/Untitled%2012.png" alt=" "></p>
<ul>
<li>참고 - 이 노트북을 실행하면 무작위 클러스터 초기화로 인해 다른 결과를 얻을 수 있음. <a target="_blank" rel="noopener" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create#kmeans_init_method">도달 범위 실행에 대해 일관되게 동일한 클러스터를 반환하려면 하이퍼파라미터 선택을 통해 초기화를 명시적으로 선택가능</a>.</li>
<li>k 선택하기:  최적의 k 값을 결정할 때 완벽한 접근 방식이나 프로세스는 정해져 있지 않음. 비즈니스 규칙이나 요구 사항에 따라 결정되는 경우가 많음.  이 예에서는 간단한 요구 사항이 없으므로 다음과 같은 고려 사항을 따를 수도 있음:<ol>
<li>항상 그런 것은 아니지만, 증분 클러스터가 손실을 크게 줄이지 못하는 자연스러운 ‘엘보 방법’이 있는 경우가 있음. 이 특정 예에서는, 그리고 종종 발견할 수 있듯이, 안타깝게도 자연스러운 ‘엘보’가 존재하지 않으므로 프로세스를 계속 진행해야 함.</li>
<li>다음으로 데이비스-볼딘과 k를 차트로 표. 이 점수는 각 클러스터가 얼마나 ‘다른지’를 알려주며, 최적 점수는 0. 클러스터가 5개인 경우 점수는 약 1.4이며, k가 9를 초과하는 경우에만 더 나은 값을 볼 수 있음.</li>
<li>마지막으로 각 모델의 차이를 해석하기 시작. 다양한 모델에 대한 평가 모듈을 검토하여 기능의 분포를 이해할 수 있음. 데이터를 통해 성별, 가구 소득, 쇼핑 습관에 따른 패턴을 찾을 수 있음.</li>
</ol>
</li>
</ul>
<h2 id="최종-클러스터-분석"><a href="#최종-클러스터-분석" class="headerlink" title="최종 클러스터 분석"></a>최종 클러스터 분석</h2><ul>
<li><p>모델의 특성을 이해하는 데는 두 가지 옵션이 있습니다.</p>
<ol>
<li>BigQuery UI를 살펴보거나 </li>
<li>모델 개체와 프로그래밍 방식</li>
</ol>
</li>
<li><p>아래에서 후자의 옵션에 대한 간단한 예제를 찾을 수 있습니다.</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">model_to_use = <span class="string">&#x27;kmeans_clusters_5&#x27;</span> <span class="comment"># User can edit this</span></span><br><span class="line">final_model = DATA_SET_ID+<span class="string">&#x27;.&#x27;</span>+model_to_use</span><br><span class="line"></span><br><span class="line">sql_get_attributes = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT</span></span><br><span class="line"><span class="string">  centroid_id,</span></span><br><span class="line"><span class="string">  feature,</span></span><br><span class="line"><span class="string">  categorical_value</span></span><br><span class="line"><span class="string">FROM</span></span><br><span class="line"><span class="string">  ML.CENTROIDS(MODEL <span class="subst">&#123;final_model&#125;</span>)</span></span><br><span class="line"><span class="string">WHERE</span></span><br><span class="line"><span class="string">  feature IN (&#x27;OS&#x27;,&#x27;gender&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">job_config = bigquery.QueryJobConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the query</span></span><br><span class="line">query_job = client.query(sql_get_attributes, job_config=job_config) <span class="comment">#API Request</span></span><br><span class="line">df_attributes = query_job.result()</span><br><span class="line">df_attributes = df_attributes.to_dataframe()</span><br><span class="line">df_attributes.head()</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%2013.png" alt=" "></p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># get numerical information about clusters</span></span><br><span class="line"></span><br><span class="line">sql_get_numerical_attributes = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">WITH T AS (</span></span><br><span class="line"><span class="string">SELECT </span></span><br><span class="line"><span class="string">  centroid_id,</span></span><br><span class="line"><span class="string">  ARRAY_AGG(STRUCT(feature AS name, </span></span><br><span class="line"><span class="string">                   ROUND(numerical_value,1) AS value) </span></span><br><span class="line"><span class="string">                   ORDER BY centroid_id) </span></span><br><span class="line"><span class="string">                   AS cluster</span></span><br><span class="line"><span class="string">FROM ML.CENTROIDS(MODEL <span class="subst">&#123;final_model&#125;</span>)</span></span><br><span class="line"><span class="string">GROUP BY centroid_id</span></span><br><span class="line"><span class="string">),</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Users AS(</span></span><br><span class="line"><span class="string">SELECT</span></span><br><span class="line"><span class="string">  centroid_id,</span></span><br><span class="line"><span class="string">  COUNT(*) AS Total_Users</span></span><br><span class="line"><span class="string">FROM(</span></span><br><span class="line"><span class="string">SELECT</span></span><br><span class="line"><span class="string">  * EXCEPT(nearest_centroids_distance)</span></span><br><span class="line"><span class="string">FROM</span></span><br><span class="line"><span class="string">  ML.PREDICT(MODEL <span class="subst">&#123;final_model&#125;</span>,</span></span><br><span class="line"><span class="string">    (</span></span><br><span class="line"><span class="string">    SELECT</span></span><br><span class="line"><span class="string">      *</span></span><br><span class="line"><span class="string">    FROM</span></span><br><span class="line"><span class="string">      <span class="subst">&#123;final_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span></span></span><br><span class="line"><span class="string">      )))</span></span><br><span class="line"><span class="string">GROUP BY centroid_id</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SELECT</span></span><br><span class="line"><span class="string">  centroid_id,</span></span><br><span class="line"><span class="string">  Total_Users,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;Apparel&#x27;) AS Apparel,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;Office&#x27;) AS Office,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;Electronics&#x27;) AS Electronics,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;LimitedSupply&#x27;) AS LimitedSupply,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;Accessories&#x27;) AS Accessories,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;ShopByBrand&#x27;) AS ShopByBrand,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;Bags&#x27;) AS Bags,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;productPrice_USD&#x27;) AS productPrice_USD,</span></span><br><span class="line"><span class="string">  (SELECT value from unnest(cluster) WHERE name = &#x27;hhi&#x27;) AS hhi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">FROM T LEFT JOIN Users USING(centroid_id)</span></span><br><span class="line"><span class="string">ORDER BY centroid_id ASC</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">job_config = bigquery.QueryJobConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the query</span></span><br><span class="line">query_job = client.query(sql_get_numerical_attributes, job_config=job_config) <span class="comment">#API Request</span></span><br><span class="line">df_numerical_attributes = query_job.result()</span><br><span class="line">df_numerical_attributes = df_numerical_attributes.to_dataframe()</span><br><span class="line">df_numerical_attributes.head()</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/BQML_Classification/Untitled%2014.png" alt=" "></p>
<ul>
<li>위의 결과를 분석해보면 1번 클러스터는 유저수가 두번째로 많고, 제일 유저수가 많은 클러스터 2번보다 구매율이 높은걸 알수 있음</li>
<li>2번 클러스터는 가장 인구가 많지만 구매 횟수가 적고 평균 지출액이 적음. 브랜드 충성도가 높다기 보다는 일회성 구매자</li>
<li>3번 클러스터는 의류에 관심이 많고 평균 구매 가격이 제일 높음. 브랜드별로 소비하진 않지만 가치가 가장 높은 고객</li>
<li>4번 클러스터는 브랜드 별로 소비를 많이 하는 고객들이 몰려 있음.</li>
<li>5번 클러스터는 사무용품에 가장 돈을 많이 사용하는 고객</li>
</ul>
</li>
</ul>
<h2 id="Export-to-GA360"><a href="#Export-to-GA360" class="headerlink" title="Export to GA360"></a>Export to GA360</h2><ul>
<li>모델을 완성한 후에는 이를 추론에 사용</li>
<li>아래 코드는 사용자를 점수화하거나 클러스터에 할당하는 방법을 간략하게 설명</li>
<li>이 코드에는 CENTROID_ID라는 레이블이 붙습니다. 이 코드 자체도 도움이 되지만, 이 점수를 다시 GA360으로 수집하는 프로세스를 권장</li>
<li>BigQuery 테이블에서 Google 애널리틱스 360으로 BigQuery ML 예측을 내보내는 가장 쉬운 방법은 <a target="_blank" rel="noopener" href="https://github.com/google/modem">MoDeM</a>(마케팅을 위한 모델 배포) 참조 구현을 사용하는 것</li>
<li>MoDeM은 Google 광고, 디스플레이 및 동영상 360, 검색 광고 360에서 최종적으로 활성화할 수 있도록 데이터를 Google 애널리틱스에 로드하는 데 도움이 됨</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">sql_score = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SELECT * EXCEPT(nearest_centroids_distance)</span></span><br><span class="line"><span class="string">FROM</span></span><br><span class="line"><span class="string">  ML.PREDICT(MODEL <span class="subst">&#123;final_model&#125;</span>,</span></span><br><span class="line"><span class="string">    (</span></span><br><span class="line"><span class="string">    SELECT</span></span><br><span class="line"><span class="string">      *</span></span><br><span class="line"><span class="string">    FROM</span></span><br><span class="line"><span class="string">      <span class="subst">&#123;final_view.full_table_id.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;.&quot;</span>)&#125;</span></span></span><br><span class="line"><span class="string">      -- LIMIT 1</span></span><br><span class="line"><span class="string">      ))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">job_config = bigquery.QueryJobConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the query</span></span><br><span class="line">query_job = client.query(sql_score, job_config=job_config) <span class="comment">#API Request</span></span><br><span class="line">df_score = query_job.result()</span><br><span class="line">df_score = df_score.to_dataframe()</span><br><span class="line"></span><br><span class="line">df_score</span><br></pre></td></tr></table></figure>

<hr>
<ul>
<li>Reference<ul>
<li><a target="_blank" rel="noopener" href="http://googleanalytics360.com/board/view.php?bo_table=googleanalytics&wr_id=34">http://googleanalytics360.com/board/view.php?bo_table&#x3D;googleanalytics&amp;wr_id&#x3D;34</a></li>
<li><a target="_blank" rel="noopener" href="https://dev-kani.tistory.com/2">https://dev-kani.tistory.com/2</a></li>
</ul>
</li>
</ul>

        </div>
        <footer class="article-footer">
            



    <a data-url="https://jmj3047.github.io/2023/03/10/BQML_Classification/" data-id="cllsxv8800006msu65aem0quj" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "Jang Minjee"
        },
        "headline": "BQML을 이용한 고객 분류",
        "image": "https://jmj3047.github.io/images/BQML_Classification/Untitled.png",
        "keywords": "Big Query BigQueryML",
        "genre": "Data Platform/Base GCP",
        "datePublished": "2023-03-10",
        "dateCreated": "2023-03-10",
        "dateModified": "2023-03-19",
        "url": "https://jmj3047.github.io/2023/03/10/BQML_Classification/",
        "description": "개요
K means clustering을 빅쿼리 ML(BQML)을 사용하여 고객을 세분화 하기
GA360의 데이터를 빅쿼리에 적재해 ML학습하기
파이썬을 사용하여 빅쿼리와 연동하고 관련 그래프 시각화하기

목표
구글 브랜드 상품을 판매하는 실제 이커머스 스토어인 구글 머천다이스 스토어의 난독화된 GA360 12개월(2016년 8월~2017년 8월)의 데이터",
        "wordCount": 4344
    }
</script>

</article>

    <section id="comments">
    
    </section>



                        </div>
                    </section>
                    
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>follow:</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/jmj3047" target="_blank" rel="noopener">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="dropbox" href="https://www.dropbox.com/home" target="_blank" rel="noopener">
                        <i class="icon fa fa-dropbox"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="google" href="https://www.google.com" target="_blank" rel="noopener">
                        <i class="icon fa fa-google"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="youtube" href="https://www.youtube.com/" target="_blank" rel="noopener">
                        <i class="icon fa fa-youtube"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="discord" href="https://discord.com/channels/@me" target="_blank" rel="noopener">
                        <i class="icon fa fa-discord"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
<!-- 
    <div class="github-card" data-github="jmj3047" data-width="400" data-height="" data-theme="default">
    </div>
    <script src="//cdn.jsdelivr.net/github-cards/latest/widget.js">    </script> -->

    
        
<nav id="article-nav">
    
        <a href="/2023/03/11/K-Means_Clustering_2/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">newer</strong>
        <p class="article-nav-title">
        
            K-Means Clustering(2)
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2023/03/09/Mac_GCP_Error/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">older</strong>
        <p class="article-nav-title">Mac VScode GCP 인증 관련 오류</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    


    <div class="widgets-container">
        
        
        
            
                

            
                
    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="no-thumbnail">
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Quant/">Quant</a></p>
                            <p class="item-title"><a href="/2025/05/10/QR_1/" class="title">Algorithmic Trading + ML + AI(1)</a></p>
                            <p class="item-date"><time datetime="2025-05-09T14:00:00.000Z" itemprop="datePublished">2025-05-10</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Quant/">Quant</a></p>
                            <p class="item-title"><a href="/2025/05/10/QR_2/" class="title">Algorithmic Trading + ML + AI(2)</a></p>
                            <p class="item-date"><time datetime="2025-05-09T14:00:00.000Z" itemprop="datePublished">2025-05-10</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Paper/">Paper</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Paper/Few-Shot-Learning/">Few Shot Learning</a></p>
                            <p class="item-title"><a href="/2024/06/14/PAPT_SER/" class="title">Personalized Adaptation with Pre-trained Speech Encoders for Continuous Emotion Recognition</a></p>
                            <p class="item-date"><time datetime="2024-06-13T15:00:00.000Z" itemprop="datePublished">2024-06-14</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Paper/">Paper</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Paper/Few-Shot-Learning/">Few Shot Learning</a></p>
                            <p class="item-title"><a href="/2024/04/08/EMOFSL_for_cross_corpus_SER/" class="title">Few Shot Learning Guided by Emotion Distance for Cross-corpus Speech Emotion Recognition</a></p>
                            <p class="item-date"><time datetime="2024-04-07T15:00:00.000Z" itemprop="datePublished">2024-04-08</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Paper/">Paper</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Paper/Few-Shot-Learning/">Few Shot Learning</a></p>
                            <p class="item-title"><a href="/2024/02/20/Transductive_Inductive/" class="title">Transductive learning VS Inductive Learning</a></p>
                            <p class="item-date"><time datetime="2024-02-19T15:00:00.000Z" itemprop="datePublished">2024-02-20</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Analysis/">Data Analysis</a><span class="category-list-count">40</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Analysis/Basic/">Basic</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Analysis/Model/">Model</a><span class="category-list-count">16</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Platform-Base/">Data Platform/Base</a><span class="category-list-count">16</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Platform-Base/GCP/">GCP</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Platform-Base/MongoDB/">MongoDB</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/">Paper</a><span class="category-list-count">29</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Computer-Vision/">Computer Vision</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Few-Shot-Learning/">Few Shot Learning</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Generative-Model/">Generative Model</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Multi-Task-Learning/">Multi-Task Learning</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/NLP/">NLP</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Recommendation-System/">Recommendation System</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Speaker-Verification/">Speaker Verification</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Speech-Emotion-Recognition/">Speech Emotion Recognition</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/Speech-Representations/">Speech Representations</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Django/">Django</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/HTML/">HTML</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Pyspark/">Pyspark</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python/">Python</a><span class="category-list-count">5</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Quant/">Quant</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Setting/">Setting</a><span class="category-list-count">5</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/ACF/" style="font-size: 10px;">ACF</a> <a href="/tags/AI-Studies/" style="font-size: 15.83px;">AI Studies</a> <a href="/tags/AI-tool/" style="font-size: 10px;">AI tool</a> <a href="/tags/ARIMA/" style="font-size: 10px;">ARIMA</a> <a href="/tags/Acoustic-Parameter-Set/" style="font-size: 10px;">Acoustic Parameter Set</a> <a href="/tags/Adaptation/" style="font-size: 10px;">Adaptation</a> <a href="/tags/Adversarial-Domain-Adaptation/" style="font-size: 10px;">Adversarial Domain Adaptation</a> <a href="/tags/Adversarial-Speaker-Verification/" style="font-size: 10px;">Adversarial Speaker Verification</a> <a href="/tags/Attention/" style="font-size: 10.83px;">Attention</a> <a href="/tags/Auth/" style="font-size: 10px;">Auth</a> <a href="/tags/Automation/" style="font-size: 10px;">Automation</a> <a href="/tags/Bash/" style="font-size: 10px;">Bash</a> <a href="/tags/BeautifulSoup/" style="font-size: 11.67px;">BeautifulSoup</a> <a href="/tags/Benchmark/" style="font-size: 10px;">Benchmark</a> <a href="/tags/Bi-Encoder/" style="font-size: 10px;">Bi Encoder</a> <a href="/tags/Big-Query/" style="font-size: 15px;">Big Query</a> <a href="/tags/BigQueryML/" style="font-size: 14.17px;">BigQueryML</a> <a href="/tags/Brython/" style="font-size: 10px;">Brython</a> <a href="/tags/CGI/" style="font-size: 10px;">CGI</a> <a href="/tags/Center-Loss/" style="font-size: 10px;">Center Loss</a> <a href="/tags/Chatbot/" style="font-size: 13.33px;">Chatbot</a> <a href="/tags/Clustering/" style="font-size: 14.17px;">Clustering</a> <a href="/tags/Confusion-Matrix/" style="font-size: 10px;">Confusion Matrix</a> <a href="/tags/Convolutional-Neural-Networks/" style="font-size: 10.83px;">Convolutional Neural Networks</a> <a href="/tags/Coursera/" style="font-size: 18.33px;">Coursera</a> <a href="/tags/Cross-Encoder/" style="font-size: 10px;">Cross Encoder</a> <a href="/tags/Cross-domain/" style="font-size: 10px;">Cross-domain</a> <a href="/tags/DBSCAN/" style="font-size: 10px;">DBSCAN</a> <a href="/tags/DCGAN/" style="font-size: 10px;">DCGAN</a> <a href="/tags/DataFlow/" style="font-size: 10px;">DataFlow</a> <a href="/tags/Decision-Tree-Classifier/" style="font-size: 10px;">Decision Tree Classifier</a> <a href="/tags/Deep-Nueral-Networks/" style="font-size: 10.83px;">Deep Nueral Networks</a> <a href="/tags/Deep-Machine-Learning-Paper-Study/" style="font-size: 17.5px;">Deep/Machine Learning Paper Study</a> <a href="/tags/Doc2vec/" style="font-size: 12.5px;">Doc2vec</a> <a href="/tags/Domain-Adaptation/" style="font-size: 10.83px;">Domain Adaptation</a> <a href="/tags/Domain-Adversarial-Layer/" style="font-size: 10px;">Domain Adversarial Layer</a> <a href="/tags/Domain-Invariant-Feature-Learning/" style="font-size: 10.83px;">Domain Invariant Feature Learning</a> <a href="/tags/English/" style="font-size: 19.17px;">English</a> <a href="/tags/Ensemble-Model/" style="font-size: 10px;">Ensemble Model</a> <a href="/tags/Error/" style="font-size: 10px;">Error</a> <a href="/tags/Evaluation/" style="font-size: 10px;">Evaluation</a> <a href="/tags/F1-measure/" style="font-size: 10px;">F1 measure</a> <a href="/tags/Few-Shot-Learning/" style="font-size: 10.83px;">Few Shot Learning</a> <a href="/tags/Flask/" style="font-size: 10px;">Flask</a> <a href="/tags/GAN/" style="font-size: 10.83px;">GAN</a> <a href="/tags/GCP/" style="font-size: 10px;">GCP</a> <a href="/tags/Gaussian-Mixture-Model/" style="font-size: 10.83px;">Gaussian Mixture Model</a> <a href="/tags/Gen-App-Builder/" style="font-size: 10px;">Gen App Builder</a> <a href="/tags/Generative-Adversarial-Network/" style="font-size: 10px;">Generative Adversarial Network</a> <a href="/tags/Generative-Model/" style="font-size: 10px;">Generative Model</a> <a href="/tags/Git/" style="font-size: 10.83px;">Git</a> <a href="/tags/Grid-Search-CV/" style="font-size: 10px;">Grid Search CV</a> <a href="/tags/HTML/" style="font-size: 11.67px;">HTML</a> <a href="/tags/Hexo/" style="font-size: 12.5px;">Hexo</a> <a href="/tags/HuBERT/" style="font-size: 10px;">HuBERT</a> <a href="/tags/Hueman/" style="font-size: 10px;">Hueman</a> <a href="/tags/Image-Classification/" style="font-size: 11.67px;">Image Classification</a> <a href="/tags/Inductive-Learning/" style="font-size: 10px;">Inductive Learning</a> <a href="/tags/K-Means-Clustering/" style="font-size: 11.67px;">K-Means Clustering</a> <a href="/tags/Kaggle/" style="font-size: 10px;">Kaggle</a> <a href="/tags/Looker-Studio/" style="font-size: 11.67px;">Looker Studio</a> <a href="/tags/ML-Analysis/" style="font-size: 20px;">ML Analysis</a> <a href="/tags/ML-Operations/" style="font-size: 10.83px;">ML Operations</a> <a href="/tags/ML-Process/" style="font-size: 10.83px;">ML Process</a> <a href="/tags/Meta-Transfer-Learning/" style="font-size: 10px;">Meta Transfer Learning</a> <a href="/tags/Metric-Learning/" style="font-size: 10px;">Metric Learning</a> <a href="/tags/Model-Generalization/" style="font-size: 10px;">Model Generalization</a> <a href="/tags/MongoDB/" style="font-size: 11.67px;">MongoDB</a> <a href="/tags/Multi-Task-Learning/" style="font-size: 10.83px;">Multi-Task Learning</a> <a href="/tags/NLP/" style="font-size: 13.33px;">NLP</a> <a href="/tags/Nonprobability-sampling/" style="font-size: 10px;">Nonprobability sampling</a> <a href="/tags/Normal-Distribution/" style="font-size: 10px;">Normal Distribution</a> <a href="/tags/PACF/" style="font-size: 10px;">PACF</a> <a href="/tags/Pandas-Dataframe/" style="font-size: 10px;">Pandas Dataframe</a> <a href="/tags/Personalization/" style="font-size: 10px;">Personalization</a> <a href="/tags/Precision-Recall/" style="font-size: 10px;">Precision-Recall</a> <a href="/tags/Probabilistic-sampling/" style="font-size: 10px;">Probabilistic sampling</a> <a href="/tags/Probability-Density-Function/" style="font-size: 10px;">Probability Density Function</a> <a href="/tags/Probability-Distribution-Function/" style="font-size: 10px;">Probability Distribution Function</a> <a href="/tags/Python/" style="font-size: 15.83px;">Python</a> <a href="/tags/Quant-Research/" style="font-size: 10.83px;">Quant Research</a> <a href="/tags/Quiz/" style="font-size: 15px;">Quiz</a> <a href="/tags/ROC-curve/" style="font-size: 10px;">ROC curve</a> <a href="/tags/Recommendation-System/" style="font-size: 10.83px;">Recommendation System</a> <a href="/tags/Representation-Learning/" style="font-size: 10px;">Representation Learning</a> <a href="/tags/Self-Supervised-Features/" style="font-size: 10px;">Self-Supervised Features</a> <a href="/tags/Self-Supervised-Learning/" style="font-size: 11.67px;">Self-Supervised Learning</a> <a href="/tags/Sentence-Bert/" style="font-size: 10px;">Sentence Bert</a> <a href="/tags/Speaker-GAN/" style="font-size: 10px;">Speaker GAN</a> <a href="/tags/Speaker-Identification/" style="font-size: 10px;">Speaker Identification</a> <a href="/tags/Speaker-Independent/" style="font-size: 10px;">Speaker Independent</a> <a href="/tags/Speaker-Normalization/" style="font-size: 10px;">Speaker Normalization</a> <a href="/tags/Speaker-Verification/" style="font-size: 10px;">Speaker Verification</a> <a href="/tags/Speaker-Verification/" style="font-size: 10px;">Speaker Verification,</a> <a href="/tags/Speech-Emotion-Recognition/" style="font-size: 16.67px;">Speech Emotion Recognition</a> <a href="/tags/Speech-Feature-Extraction/" style="font-size: 10px;">Speech Feature Extraction</a> <a href="/tags/Speech-Representations/" style="font-size: 10px;">Speech Representations</a> <a href="/tags/Spoken-Language-Understanding/" style="font-size: 10px;">Spoken Language Understanding</a> <a href="/tags/Standard-Normal-Distribution/" style="font-size: 10px;">Standard Normal Distribution</a> <a href="/tags/TD-SV/" style="font-size: 10px;">TD-SV</a> <a href="/tags/Threshold-Adjustment/" style="font-size: 10px;">Threshold Adjustment</a> <a href="/tags/Time-Series/" style="font-size: 10px;">Time Series</a> <a href="/tags/Transductive-Learning/" style="font-size: 10px;">Transductive Learning</a> <a href="/tags/Transfer-Learning/" style="font-size: 10px;">Transfer Learning</a> <a href="/tags/Transformer/" style="font-size: 11.67px;">Transformer</a> <a href="/tags/Vertex-AI/" style="font-size: 10px;">Vertex AI</a> <a href="/tags/Virtualenv/" style="font-size: 10px;">Virtualenv</a> <a href="/tags/Voice-Trigger-Detection/" style="font-size: 10.83px;">Voice Trigger Detection</a> <a href="/tags/WGAN/" style="font-size: 10px;">WGAN</a> <a href="/tags/WGAN-GP/" style="font-size: 10px;">WGAN-GP</a> <a href="/tags/Wake-Up-Words/" style="font-size: 10px;">Wake-Up Words</a> <a href="/tags/Wav2vec-2-0/" style="font-size: 10px;">Wav2vec 2.0</a> <a href="/tags/Web-Crawling/" style="font-size: 11.67px;">Web Crawling</a> <a href="/tags/Web-Server/" style="font-size: 10.83px;">Web Server</a> <a href="/tags/kaggle/" style="font-size: 10px;">kaggle</a> <a href="/tags/pyspark/" style="font-size: 12.5px;">pyspark</a>
        </div>
    </div>


            
        

    </div>
</aside>


                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2025 Jang Minjee</p>
                
                <p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/ppoffice" target="_blank">PPOffice</a></p>
                
            </div>
            <div class="footer-plugins">
              
    


            </div>
        </div>
    </div>
</footer>

    </div>
    


    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML.js"></script>

    

    
      <script data-ad-client="ca-pub-2182912223281192" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    
    
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


</body>
</html>
